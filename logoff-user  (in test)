param(
    [Parameter(Mandatory=$true)]
    [string]$serverName
)

# Function to ask for the server name if not provided as a parameter
function Get-ServerName {
    if (-not $serverName) {
        $serverName = Read-Host "Please enter the server name:"
        return $serverName
    }
}

# Prompting the user for the server name if not provided as a parameter
Get-ServerName

# Now you can use the $serverName variable as needed in your script
# For example, you can use it to connect to the server or perform other actions.

Write-Host "You entered Server Name: $serverName"

# Executing the "query session" command on the specified server
$querySessionOutput = Invoke-Command -ComputerName $serverName -ScriptBlock { query session }

# Displaying the output of the "query session" command in vertical list
Write-Host ("Session Information on {0}:" -f $serverName)
$querySessionOutput -split '\r?\n' | ForEach-Object { Write-Host $_ }

# Prompt the user for a session ID to log off
$sessionId = Read-Host "Please enter the Session ID you want to log off:"

# Log off the specified user session
try {
    Invoke-Command -ComputerName $serverName -ScriptBlock { logoff $using:sessionId } -ErrorAction Stop
    Write-Host "User session with Session ID $sessionId has been logged off successfully."
} catch {
    Write-Host "Error: Unable to log off user session with Session ID $sessionId."
}
