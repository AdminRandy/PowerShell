$serverName = Read-Host "Enter the server name"; if ($serverName -eq "") { Write-Host "Server name is mandatory. Please provide a valid server name." } else { try { Test-Connection -ComputerName $serverName -Count 1 -ErrorAction Stop; Write-Host "Connection to $serverName successful."; $clusterStatus = Invoke-Command -ComputerName $serverName -ScriptBlock { & "hastatus.exe" -sum }; $clusterStatus -split '\r?\n' | ForEach-Object { Write-Host $_ } } catch { Write-Host "Connection to $serverName failed. Error: $($_.Exception.Message)" } }
