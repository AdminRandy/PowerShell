param([Parameter(Mandatory=$true)][string]$serverName);function Get-ServerName{if(-not $serverName){$serverName=Read-Host "Please enter the server name:";return $serverName}};Get-ServerName;Write-Host "You entered Server Name: $serverName";$querySessionOutput=Invoke-Command -ComputerName $serverName -ScriptBlock {query session};Write-Host ("Session Information on {0}:" -f $serverName);$querySessionOutput -split '\r?\n'|ForEach-Object{Write-Host $_};$sessionIds=Read-Host "Please enter the Session IDs (comma-separated) you want to log off:";$sessionIdsArray=$sessionIds -split ','|ForEach-Object{$_ -replace '\s', ''};foreach($sessionId in $sessionIdsArray){try{Invoke-Command -ComputerName $serverName -ScriptBlock {logoff $using:sessionId} -ErrorAction Stop;Write-Host "User session with Session ID $sessionId has been logged off successfully."}catch{Write-Host "Error: Unable to log off user session with Session ID $sessionId."}};Start-Sleep -Seconds 5;$querySessionOutputAfterDelay=Invoke-Command -ComputerName $serverName -ScriptBlock {query session};Write-Host ("Updated Session Information on {0} after delay:" -f $serverName);$querySessionOutputAfterDelay -split '\r?\n'|ForEach-Object{Write-Host $_}

