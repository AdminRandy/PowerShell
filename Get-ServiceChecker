$serverName = Read-Host "Enter the name of the server"; $serviceNamesArray = (Read-Host "Enter the names of the services (comma-separated)") -split ',' | ForEach-Object { $_.Trim() }; foreach ($serviceName in $serviceNamesArray) { $service = Get-Service -Name $serviceName -ComputerName $serverName; if ($service -eq $null) { Write-Host "Service $serviceName not found on server $serverName." } else { Write-Host "Current Service Status for $($serviceName):"; $service | Format-Table -AutoSize; if ($service.Status -eq "Stopped") { $startService = Read-Host "Service $serviceName is stopped. Do you want to start it? (yes/no)"; if ($startService -eq "yes") { Invoke-Command -ComputerName $serverName -ScriptBlock { param ($serviceName) Start-Service -Name $serviceName } -ArgumentList $serviceName; Write-Host "Service $serviceName started."; $service = Get-Service -Name $serviceName -ComputerName $serverName; Write-Host "Updated Service Status for $($serviceName):"; $service | Format-Table -AutoSize } else { Write-Host "Service $serviceName was not started." } } else { Write-Host "Service $serviceName is already running." } } Write-Host ("-" * 40) }
