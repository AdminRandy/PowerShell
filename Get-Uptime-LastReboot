param([Parameter(Mandatory=$true,HelpMessage='Client name(s)')]$client);$CurrentLocation=Get-Location;$SQLInstance="GhostHub";$GhostHubSQLServer="czchowv935.prg-dc.dhl.com,5002";$finaloutput=@();foreach($clt in $client){$ParentGhostSQL="SELECT [Ghost] FROM [GhostHub].[dbo].[Clients] WHERE [Client] = '$clt'";$ParentGhost=Invoke-Sqlcmd -query $ParentGhostSQL -ServerInstance ($GhostHubSQLServer+"\"+$SQLInstance);$systemInfo=Get-WmiObject Win32_OperatingSystem -ComputerName $clt;$lastBootUpTime=$systemInfo.ConvertToDateTime($systemInfo.LastBootUpTime);$uptime=(Get-Date)-$lastBootUpTime;$uptimeDays=$uptime.Days;$uptimeHours=$uptime.Hours;$uptimeMinutes=$uptime.Minutes;$output=@{"Client"=$clt;"Ghost"=$ParentGhost.Ghost;"LastBootUpTime"=$lastBootUpTime;"Uptime"="$uptimeDays Day(s), $uptimeHours Hour(s), $uptimeMinutes Minute(s)"};$OutputObj=New-Object -TypeName psobject -Property $output;$finaloutput+=$OutputObj};$finaloutput|ForEach-Object{Write-Host ("Client         : "+$_.Client) -ForegroundColor Green;Write-Host ("Ghost          : "+$_.Ghost) -ForegroundColor Green;Write-Host ("LastBootUpTime : "+$_.LastBootUpTime) -ForegroundColor Green;Write-Host ("Uptime         : "+$_.Uptime) -ForegroundColor Green;Write-Host ""};Set-Location $CurrentLocation
